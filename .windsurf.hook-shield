#!/usr/bin/env python3
"""
🛡️ WINDSURF PHOENIX OMEGA SANCTUM HOOK SHIELD v13.0

Prevents future hook corruption and auto-detects Python mismatches.
Installed in git hooks to provide immortal protection.

LOCKED VERSION: Python 3.12.8
STATUS: IMMORTAL PROTECTION ACTIVE
"""

import sys
import os


def validate_environment() -> bool:
    """Validate Python environment before any git operation"""
    required_version = "3.12.8"
    current_version = (
        f"{sys.version_info.major}.{sys.version_info.minor}.{sys.version_info.micro}"
    )

    if current_version != required_version:
        print("\n🛡️ WINDSURF HOOK SHIELD BLOCK!")
        print("   Python version mismatch detected")
        print(f"   Required: {required_version}")
        print(f"   Current:  {current_version}")
        print("\n🔧 Fix: Run './windsurf_autofix.py' to repair environment")
        return False

    if not os.environ.get("VIRTUAL_ENV"):
        print("\n🛡️ WINDSURF HOOK SHIELD BLOCK!")
        print("   Virtual environment not active")
        print("\n🔧 Fix: Run 'source .venv/bin/activate' first")
        return False

    return True


if __name__ == "__main__":
    if not validate_environment():
        sys.exit(1)
    print("🛡️ Hook Shield: Environment validated ✅")
